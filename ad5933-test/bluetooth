import serial

# Bluetooth connection settings
bluetooth_port = 'COMX'  # Replace with the actual Bluetooth port
baud_rate = 9600

# CSV file settings
csv_filename = 'data.csv'  # Name of the output CSV file

# Open the Bluetooth serial port
bluetooth = serial.Serial(bluetooth_port, baud_rate)

# Create the CSV file
with open(csv_filename, 'w') as csv_file:
    while True:
        # Read a line from the Bluetooth connection
        line = bluetooth.readline().decode().strip()

        if line:
            # Write the received line to the CSV file
            csv_file.write(line + '\n')
            csv_file.flush()  # Ensure the data is written immediately

        # Add a condition to break the loop if needed

# Close the Bluetooth connection
bluetooth.close()
